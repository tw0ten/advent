#!/bin/sh
set -e && export SHELLOPTS
mkdir -p io/o

ghc src/Main.hs lib/* \
	-outputdir io/o \
	-o io/o/run

cd io

( mkdir -p i
	set -- "$(cat i/session)"
	echo -n '..'
	for i in {1..3}; do (
		set -- "session=$1" "i/$i" "https://adventofcode.com/2024/day/$i"
		echo -n " $i"
		[ -f "$2" ] ||
			curl -fs -o "$2" \
				-b "$1" "$3/input" || true
	) done
echo )

echo 'advent-24'
o/run
